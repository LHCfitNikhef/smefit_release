
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Nested Sampling &#8212; SMEFiT 3.1.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=f74d80cf" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=2d67777c"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'theory/NS';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Analytic solution" href="Analytic.html" />
    <link rel="prev" title="Fitting assumptions" href="general.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">SMEFiT 3.1.1 documentation</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Theory:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="SMEFT.html">Standard Model Effective Field Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="general.html">Fitting assumptions</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Nested Sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="Analytic.html">Analytic solution</a></li>
<li class="toctree-l1"><a class="reference internal" href="MCFit.html">The Monte Carlo replica method</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Data and theory tables:</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../data_theory/data.html">Experimental data format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_theory/theory.html">Theory tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_theory/covariance.html">Construction of the fit covariance matrix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_theory/rotation.html">Basis rotation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_theory/projections.html">Projections</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Fitting code:</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../fitting_code/code_struct.html">Code structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fitting_code/running.html">How to run the code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fitting_code/tutorial.html">SMEFiT Tutorial</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reports:</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../report/tools.html">Report functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../report/running.html">Produce a report</a></li>
<li class="toctree-l1"><a class="reference internal" href="../report/links.html">Link to reports</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Previous studies:</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../previous_releases/smefit_rw.html">SMEFiT RW</a></li>
<li class="toctree-l1"><a class="reference internal" href="../previous_releases/smefit_top.html">SMEFiT Top</a></li>
<li class="toctree-l1"><a class="reference internal" href="../previous_releases/smefit_vbs.html">SMEFiT VBS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../previous_releases/smefit20.html">SMEFiT2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../previous_releases/smefit_uv.html">The automation of SMEFT-Assisted Constraints on UV-Complete Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../previous_releases/smefit30.html">SMEFiT3.0</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Collaboration:</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../people/people.html">People</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">References &amp; API:</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../modules/smefit/smefit.html">API</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../modules/smefit/smefit.analyze.html">smefit.analyze package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/smefit/smefit.cli.html">smefit.cli package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/smefit/smefit.optimize.html">smefit.optimize package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/smefit/smefit.postfit.html">smefit.postfit package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/smefit/smefit.prefit.html">smefit.prefit package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/smefit/smefit.projections.html">smefit.projections package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/smefit/smefit.rge.html">smefit.rge package</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../zzz-refs.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/theory/NS.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Nested Sampling</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#formalism">Formalism</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prior-volume">Prior volume</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#performance">Performance</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="nested-sampling">
<h1>Nested Sampling<a class="headerlink" href="#nested-sampling" title="Link to this heading">#</a></h1>
<p><abbr title="Standard Model Effective Field Theory fitter">SMEFiT</abbr> implements one fitting strategies using Ultranest and <a class="reference internal" href="#"><span class="doc">Nested Sampling</span></a>
algorithm <span id="id1">[<a class="reference internal" href="../zzz-refs.html#id21" title="Johannes Buchner. Collaborative nested sampling: big data versus complex physical models. Publications of the Astronomical Society of the Pacific, 131(1004):108005, aug 2019. URL: https://doi.org/10.1088%2F1538-3873%2Faae7fc, doi:10.1088/1538-3873/aae7fc.">Buc19</a>, <a class="reference internal" href="../zzz-refs.html#id20" title="F. Feroz, M. P. Hobson, E. Cameron, and A. N. Pettitt. Importance Nested Sampling and the MultiNest Algorithm. 2013. arXiv:1306.2144, doi:10.21105/astro.1306.2144.">FHCP13</a>, <a class="reference internal" href="../zzz-refs.html#id19" title="Farhan Feroz and M.P. Hobson. Multimodal nested sampling: an efficient and robust alternative to MCMC methods for astronomical data analysis. Mon. Not. Roy. Astron. Soc., 384:449, 2008. arXiv:0704.3704, doi:10.1111/j.1365-2966.2007.12353.x.">FH08</a>]</span>, a robust sampling procedure is based on Bayesian inference.
The actual implemtation is based on the package <a class="reference external" href="https://johannesbuchner.github.io/UltraNest/index.html">Ultranest</a></p>
<section id="formalism">
<h2>Formalism<a class="headerlink" href="#formalism" title="Link to this heading">#</a></h2>
<p>The starting point of Nested Sampling (<abbr title="Nested Sampling">NS</abbr>) is Bayes’ theorem, which allows us to evaluate the
probability distribution of a set of parameters <span class="math notranslate nohighlight">\(\vec{c}\)</span>
associated to a model <span class="math notranslate nohighlight">\(\mathcal{M}(\vec{c})\)</span>
given a set of experimental measurements <span class="math notranslate nohighlight">\(\mathcal{D}\)</span> ,</p>
<div class="math notranslate nohighlight">
\[P\left(\vec{c}| \mathcal{D},\mathcal{M} \right) = \frac{P\left(\mathcal{D}|\mathcal{M},\vec{c}  \right) P\left( \vec{c}|\mathcal{M}  \right) }{P(\mathcal{D}|\mathcal{M})} \, .\]</div>
<p>Here <span class="math notranslate nohighlight">\(P\left(\vec{c}| \mathcal{D},\mathcal{M} \right)\)</span>  represents the posterior
probability of the model parameters given the assumed model and the observed
experimental data,
<span class="math notranslate nohighlight">\(P\left(\mathcal{D}|\mathcal{M},\vec{c}\right) = \mathcal{L}\left(\vec{c} \right)\)</span>  is the likelihood (conditional
probability) of the experimental measurements
given the model and a specific choice of parameters,
and <span class="math notranslate nohighlight">\(P\left( \vec{c}|\mathcal{M}  \right) = \pi \left(  \vec{c} \right)\)</span>
is the prior distribution for the model parameters.</p>
<p>The denominator in the equation above, <span class="math notranslate nohighlight">\(P(\mathcal{D}|\mathcal{M}) = \mathcal{Z}\)</span> ,
is known as the Bayesian evidence and ensures the normalization of the posterior distribution,</p>
<div class="math notranslate nohighlight">
\[\mathcal{Z} = \int \mathcal{L}\left(  \vec{c} \right)\pi \left(  \vec{c} \right) d \vec{c} \, ,\]</div>
<p>where the integration is carried out over the domain of the model parameters <span class="math notranslate nohighlight">\(\vec{c}\)</span> .</p>
<p>The key ingredient of <abbr title="Nested Sampling">NS</abbr> utilise the ideas underlying
Bayesian inference to map the <span class="math notranslate nohighlight">\(n\)</span> -dimensional integral over the prior density
in model parameter space <span class="math notranslate nohighlight">\(\pi(\vec{c} )d\vec{c}\)</span> ,
where <span class="math notranslate nohighlight">\(n\)</span>  represents the dimensionality of <span class="math notranslate nohighlight">\(\vec{c}\)</span> , into a one-dimensional function
of the form</p>
<div class="math notranslate nohighlight">
\[X(\lambda) = \int_{\{ \vec{c} : \mathcal{L}\left(\vec{c} \right) &gt; \lambda \}}\pi(\vec{c} ) d\vec{c} \,.\]</div>
<p>In this expression, the prior mass <span class="math notranslate nohighlight">\(X(\lambda)\)</span>  corresponds to the
(normalized) volume
of the prior density <span class="math notranslate nohighlight">\(\pi(\vec{c} )d\vec{c}\)</span>  associated with values
of the model parameters that lead to a likelihood <span class="math notranslate nohighlight">\(\mathcal{L}\left(\vec{c}\right) `  greater
than the parameter :math:\)</span>lambda` .
Note that by construction, the prior mass <span class="math notranslate nohighlight">\(X\)</span>  decreases monotonically
from the limiting value <span class="math notranslate nohighlight">\(X=1\)</span>  to <span class="math notranslate nohighlight">\(X=0\)</span>  as <span class="math notranslate nohighlight">\(\lambda\)</span>  is increased.
The integration of <span class="math notranslate nohighlight">\(X(\lambda)\)</span>  extends over the regions in the model parameter space contained
within the fixed-likelihood contour defined by the condition <span class="math notranslate nohighlight">\(\mathcal{L}\left(\vec{c}\right) =\lambda\)</span>.</p>
<p>This property allows the evidence to be expressed as,</p>
<div class="math notranslate nohighlight">
\[\mathcal{Z} = \int_0^1  \mathcal{L}\left( X\right) dX \, ,\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathcal{L}\left( X\right)\)</span>  is defined as the inverse function of <span class="math notranslate nohighlight">\(X(\lambda)\)</span> , which
always exists provided the likelihood is a continuous and smooth function
of the model parameters.
Therefore, the transformation from <span class="math notranslate nohighlight">\(\vec{c}\)</span>
to X  achieves a mapping of the prior distribution into infinitesimal
elements, sorted by their associated likelihood <span class="math notranslate nohighlight">\(\mathcal{L}(\vec{c})\)</span> .</p>
<p>The next step of the NS algorithm is to define a decreasing sequence of values in the prior
volume, that is now parameterized by the prior mass <span class="math notranslate nohighlight">\(X\)</span> .
In other words, one slices the prior volume into a large number of
small regions</p>
<div class="math notranslate nohighlight">
\[1 = X_0 &gt; X_1 &gt; \ldots X_{\infty} = 0 \, ,\]</div>
<p>and then evaluates the likelihood at each of these values, <span class="math notranslate nohighlight">\(\mathcal{L}=\mathcal{L}(X_i)\)</span> .</p>
<p>This way, all of the <span class="math notranslate nohighlight">\(\mathcal{L}_i\)</span>  values
can be summed in order to  evaluate the integral
for the Bayesian evidence.
Since in general the likelihood <span class="math notranslate nohighlight">\(\mathcal{L}({\boldsymbol c})\)</span>  exhibits a complex dependence
on the model parameters <span class="math notranslate nohighlight">\(\vec{c}\)</span> , the summation
above must be evaluated
numerically using {it e.g.} Monte Carlo integration methods.</p>
<p>In practice, one draws <span class="math notranslate nohighlight">\(N_{\rm live}\)</span>  points from the parameter prior
volume <span class="math notranslate nohighlight">\(\pi\left(\vec{c} \right)\)</span> , known as {it live points}, and orders
the likelihood values from smallest to largest, including the
starting value of the prior mass at <span class="math notranslate nohighlight">\(X_0=1\)</span>. As samples are drawn from the prior volume,
the live point with the lowest likelihood <span class="math notranslate nohighlight">\(\mathcal{L}_i\)</span>
is removed from the set and replaced by another live point drawn from the same prior
distribution but now under the constraint that its likelihood is larger than
<span class="math notranslate nohighlight">\(\mathcal{L}_i\)</span>. This sampling process is repeated until the entire hyper-volume
<span class="math notranslate nohighlight">\(\pi \left( \vec{c} \right)\)</span>  of the prior parameter space has been covered, with ellipsoids of constrained likelihood being assigned to the live-points as the prior volume is scanned. While the end result of the NS procedure is the estimation of the  Bayesian evidence <span class="math notranslate nohighlight">\(\mathcal{Z}\)</span> , as a byproduct one also obtains  a sampling of the posterior distribution associated to the EFT coefficients expressed as</p>
<div class="math notranslate nohighlight">
\[\{ \vec{c}^{(k)} \}\, ,\qquad  k=1,\dots,N_{\rm spl}\, ,\]</div>
<p>with <span class="math notranslate nohighlight">\(N_{\rm spl}\)</span>  indicating the number
of samples drawn by the final NS iteration.</p>
<p>One can then compute expectation values and variances of the model
parameters by evaluating the MC sum over the these posterior samples together
with their associated weights, in the same
way as averages are done
over the <span class="math notranslate nohighlight">\(N_{\rm rep}\)</span> replicas in the MCfit method.</p>
</section>
<section id="prior-volume">
<h2>Prior volume<a class="headerlink" href="#prior-volume" title="Link to this heading">#</a></h2>
<p>An important input for NS is the choice of prior volume <span class="math notranslate nohighlight">\(\pi \left( \vec{c} \right)\)</span>
in the model parameter space.
In this analysis, we adopt flat priors
defined by ranges in parameter space for the coefficients <span class="math notranslate nohighlight">\(\vec{c}\)</span> .
A suitable choice of prior volume where the sampling takes place is important
to speed up the NS algorithm: a range too wide will make the optimization less
efficient, while a range too narrow might bias the results by cutting
specific regions of the parameter space that are relevant.
Furthermore, using a common range for all parameters should be avoided,
since the range of intrinsic variation will be rather different for each
of the EFT coefficients.</p>
<p>Taking these considerations into account, we adopt here the following strategy.
First, a single model parameter <span class="math notranslate nohighlight">\(c_i\)</span>  is allowed to vary
while all others are set to their SM value, <span class="math notranslate nohighlight">\(c_j=0\)</span>  for <span class="math notranslate nohighlight">\(j\ne i\)</span> .
The <span class="math notranslate nohighlight">\(\chi^2 \left( c_i \right)\)</span>  is then scanned in this
direction to determine the values <span class="math notranslate nohighlight">\(c_i^{\rm (min)}\)</span>  and  <span class="math notranslate nohighlight">\(c_i^{\rm (max)}\)</span>
satisfying the condition <span class="math notranslate nohighlight">\(\chi^2/n_{\rm dat}=4\)</span> .
We then repeat this procedure
for all parameters and end up with a hyper-volume
defined by pairs of values <span class="math notranslate nohighlight">\(\left( c_i^{\rm (min)},c_i^{\rm (max)} \right)\)</span>  with
<span class="math notranslate nohighlight">\(i=1,\ldots, n_{\rm op}\)</span>  which defines our initial prior volume.</p>
<p>At this point, one performs an initial exploratory NS global analysis using this
volume to study the posterior probability distribution
for each EFT coefficient.
Our final analysis is then obtained by manually adjusting the
initial sampling ranges until the full posterior distributions are captured for the chosen
prior volume.
For parameters that are essentially unconstrained in the global fit,
such as the four-heavy operators in the case of linear EFT calculations,
a hard boundary of <span class="math notranslate nohighlight">\(\left( -50 , 50 \right)\)</span>  (for <span class="math notranslate nohighlight">\(\Lambda=1\)</span>  TeV) is imposed.</p>
</section>
<section id="performance">
<h2>Performance<a class="headerlink" href="#performance" title="Link to this heading">#</a></h2>
<p>To increase the efficiency of the posterior probability estimation by NS,
we set <cite>lepsilon=0.05</cite>, which adjusts the
total volume of ellipsoids spanning the live points so that the sampling
efficiency is close to its associated hyperparameter set by the user.
With 24 cpu cores,
we are able to achieve an accurate posterior for the linear EFT fits
in <span class="math notranslate nohighlight">\(\sim 30\)</span>  minutes using 500 live points, a target efficiency of 0.05, and
an evidence tolerance of 0.5, which results in <span class="math notranslate nohighlight">\(N_{\rm spl}\simeq 5000\)</span>  posterior samples.
To ensure the stability of our final results, we chose
1000 live points and a target efficiency of
0.005, which yields <span class="math notranslate nohighlight">\(\simeq 1.5\times 10^4\)</span>  samples for the
linear analysis and <span class="math notranslate nohighlight">\(\simeq 10^4\)</span>  samples for an analysis that includes also the quadratic EFT
corrections.
With these settings, our final global analyses containing the simultaneous
determination of <span class="math notranslate nohighlight">\(n_{\rm op}\simeq 36\)</span>  coefficients
take <span class="math notranslate nohighlight">\(\sim 3.5\)</span>  hours running in 24 cpu cores, with a similar performance for
linear and quadratic EFT fits.</p>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="general.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Fitting assumptions</p>
      </div>
    </a>
    <a class="right-next"
       href="Analytic.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Analytic solution</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#formalism">Formalism</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prior-volume">Prior volume</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#performance">Performance</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jaco ter Hoeve, Luca Mantani, Alejo Rossia, Giacomo Magni, Tommaso Giani and Juan Rojo
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025, the SMEFiT developers&#39; team.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>